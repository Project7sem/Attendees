<!DOCTYPE html>
<html>
<head>
    <title>Camera Feed</title>
</head>
<body>
    <h1>Camera Feed</h1>
    <canvas id="canvas"></canvas>
    <script>
        // Get the canvas element
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Define the URL to retrieve the camera feed from
        const url = '{% url "attendance" %}';

        // Define a function to draw each frame onto the canvas
        function drawFrame(frame) {
            const img = new Image();
            img.src = URL.createObjectURL(frame);
            img.onload = () => {
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                URL.revokeObjectURL(frame);
            };
        }

        // Use Fetch API to retrieve each frame from the server
        fetch(url)
            .then(response => response.body)
            .then(body => {
                const reader = body.getReader();
                const pump = () => {
                    reader.read().then(({done, value}) => {
                        if (!done) {
                            drawFrame(value);
                            pump();
                        }
                    });
                };
                pump();
            });
    </script>
</body>
</html>
